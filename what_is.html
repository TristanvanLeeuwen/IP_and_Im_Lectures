
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1. What is an inverse problem &#8212; 10 Lectures on Inverse Problems and Imaging</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2. Discrete Inverse Problems and Regularization" href="discrete_ip_regularization.html" />
    <link rel="prev" title="Welcome to Inverse Problems and Imaging" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">10 Lectures on Inverse Problems and Imaging</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome to Inverse Problems and Imaging
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   1. What is an inverse problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="discrete_ip_regularization.html">
   2. Discrete Inverse Problems and Regularization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ip_function_spaces.html">
   3. Linear inverse problems in function spaces
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="statistical_perspective.html">
   4. A statistical perspective on inverse problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="variational_formulations.html">
   5. Variational formulations for inverse problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="numerical_optimisation.html">
   6. Numerical optimization for inverse problems
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Applications
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="image_processing.html">
   7. Image processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tomography.html">
   8. Computed Tomography
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wavefield_imaging.html">
   9. Wavefield Imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="magnetic_resonance_imaging.html">
   10. Magnetic Resonance Imaging
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="bibliography.html">
   11. References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="_sources/what_is.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/what_is.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        
        
        <a class="edit-button" href="https://github.com/TristanvanLeeuwen/IP_and_Im_Lectures/edit/master/what_is.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/TristanvanLeeuwen/IP_and_Im_Lectures/master?urlpath=tree/what_is.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#applications">
   1.1. Applications
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#image-processing">
     1.1.1. Image processing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#x-ray-tomography">
     1.1.2. X-ray tomography
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#magnetic-resonance-imaging">
     1.1.3. Magnetic resonance imaging
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#seismic-inversion">
     1.1.4. Seismic inversion
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#anatomy-of-an-inverse-problems">
   1.2. Anatomy of an inverse problems
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivating-examples">
   1.3. Motivating examples
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rootfinding">
     1.3.1. Rootfinding
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-inversion">
     1.3.2. Matrix inversion
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#differentiation">
     1.3.3. Differentiation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solving-an-inverse-problem">
   1.4. Solving an inverse problem
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#direct-methods">
     1.4.1. Direct methods
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variational-methods">
     1.4.2. Variational methods
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#excercises">
   1.5. Excercises
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-inversion-i">
     1.5.1. Matrix inversion I
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-inversion-ii">
     1.5.2. Matrix inversion II
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#differentiation-i">
     1.5.3. Differentiation I
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#assignments">
   1.6. Assignments
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#differentiation-ii">
     1.6.1. Differentiation II
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>What is an inverse problem</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#applications">
   1.1. Applications
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#image-processing">
     1.1.1. Image processing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#x-ray-tomography">
     1.1.2. X-ray tomography
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#magnetic-resonance-imaging">
     1.1.3. Magnetic resonance imaging
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#seismic-inversion">
     1.1.4. Seismic inversion
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#anatomy-of-an-inverse-problems">
   1.2. Anatomy of an inverse problems
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivating-examples">
   1.3. Motivating examples
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rootfinding">
     1.3.1. Rootfinding
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-inversion">
     1.3.2. Matrix inversion
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#differentiation">
     1.3.3. Differentiation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solving-an-inverse-problem">
   1.4. Solving an inverse problem
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#direct-methods">
     1.4.1. Direct methods
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variational-methods">
     1.4.2. Variational methods
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#excercises">
   1.5. Excercises
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-inversion-i">
     1.5.1. Matrix inversion I
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-inversion-ii">
     1.5.2. Matrix inversion II
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#differentiation-i">
     1.5.3. Differentiation I
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#assignments">
   1.6. Assignments
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#differentiation-ii">
     1.6.1. Differentiation II
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="what-is-an-inverse-problem">
<h1><span class="section-number">1. </span>What is an inverse problem<a class="headerlink" href="#what-is-an-inverse-problem" title="Permalink to this headline">¶</a></h1>
<p>Mathematical models and data play a big role in modern science and engineering. The field of inverse problems bridges these two and studies if and how one can infer model parameters from relevant observations. A prominent example is the famous black hole image, shown in <a class="reference internal" href="#blackhole"><span class="std std-numref">Fig. 1.1</span></a>, that was constructed by merging data from various telescopes <span id="id1">[<a class="reference internal" href="bibliography.html#id2" title="Kazunori Akiyama, Antxon Alberdi, Walter Alef, Keiichi Asada, Rebecca Azulay, Anne-Kathrin Baczko, David Ball, Mislav Baloković, John Barrett, Dan Bintley, and others. First m87 event horizon telescope results. iv. imaging the central supermassive black hole. The Astrophysical Journal Letters, 875(1):L4, 2019.">Akiyama <em>et al.</em>, 2019</a>]</span>.</p>
<div class="figure align-default" id="blackhole">
<a class="reference internal image-reference" href="_images/blackhole.png"><img alt="_images/blackhole.png" src="_images/blackhole.png" style="height: 150px;" /></a>
<p class="caption"><span class="caption-number">Fig. 1.1 </span><span class="caption-text">Depiction of a black hole as reconstructed from data recorded by the Event Horizon Telescope.</span><a class="headerlink" href="#blackhole" title="Permalink to this image">¶</a></p>
</div>
<p>A prominent subfield of inverse problems is that of imaging, with applications in chemistry, biology, geosciences, and medicine. Various methods for imaging have been developed over the previous four decades and have been partly made available for practical use. What sets many of these imaging modalities aside from conventional photography is that the raw data is not interpretable as an image directly. Instead, significant processing using mathematical models is required to obtain a useable image. Next, we give a few examples.</p>
<div class="section" id="applications">
<h2><span class="section-number">1.1. </span>Applications<a class="headerlink" href="#applications" title="Permalink to this headline">¶</a></h2>
<div class="section" id="image-processing">
<h3><span class="section-number">1.1.1. </span>Image processing<a class="headerlink" href="#image-processing" title="Permalink to this headline">¶</a></h3>
<p>Images are of great importance in many applications, ranging from microscopy, medicine, to astronomy. In all these applications, the recorded images are distorted or corrupted versions of the ideal image. The inverse problem consists of reconstructing the idealized image from the measured one.</p>
<p>We can think of a (digital) image as a two dimensional array of pixels where each element could, for example, represent the grey value of the corresponding pixel. A color image could be represented by a tensor containing the RGB intensities for each pixel. Alternatively, we can think of an idealized image as a (vector-valued) function on a bounded domain (say, the unit square).</p>
<p>A mathematical model for the observed image should model the process by which the image was obtained. This often involves <a class="reference external" href="https://en.wikipedia.org/wiki/Convolution">convolving</a> the image with a filter and adding noise. For example, for a digital image with pixel values <span class="math notranslate nohighlight">\(u_{i}\)</span>, the measured image can in many cases be modeled as</p>
<div class="math notranslate nohighlight">
\[
f_{i} = \sum_{j\in\mathbb{Z}^2} k_{i,j}u_{j},
\]</div>
<p><span class="math notranslate nohighlight">\(i = (i_1,i_2)\)</span> and <span class="math notranslate nohighlight">\(j = (j_1,j_2)\)</span> are <a class="reference external" href="https://en.wikipedia.org/wiki/Multi-index_notation">multi-indices</a> and <span class="math notranslate nohighlight">\(k: \mathbb{Z}^2 \times \mathbb{Z}^2 \rightarrow \mathbb{R}\)</span> is the filter.</p>
<p>Representing the image as a function <span class="math notranslate nohighlight">\(u : \Omega \rightarrow \mathbb{R}\)</span>, we may have</p>
<div class="math notranslate nohighlight">
\[
f(x) = \int_{\Omega} k(x-y)u(y)\mathrm{d}y,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\Omega \subset \mathbb{R}^2\)</span> is the image domain and <span class="math notranslate nohighlight">\(k: \Omega \times \Omega \rightarrow \mathbb{R}\)</span> is the convolution kernel or <a class="reference external" href="https://en.wikipedia.org/wiki/Point_spread_function"><em>point spread function</em></a>.</p>
<p>The resulting inverse problem is to undo the convolution. In some cases, <span class="math notranslate nohighlight">\(k\)</span> may not be known perfectly, in which case it is called <em>blind deconvolution</em>. Other image-related inverse problems include <em>denoising</em>, where a noisy version of the image is measured, and <em>inpainting</em>, where a significant part of the pixels are missing. Some examples are shown below.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import libaries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">convolve2d</span> <span class="k">as</span> <span class="n">conv2</span>
<span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">color</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">restoration</span>
<span class="kn">from</span> <span class="nn">skimage.restoration</span> <span class="kn">import</span> <span class="n">inpaint</span>

<span class="c1"># load test image and convert to gray-scale</span>
<span class="n">astro</span> <span class="o">=</span> <span class="n">color</span><span class="o">.</span><span class="n">rgb2gray</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">astronaut</span><span class="p">())</span>

<span class="c1">## image deblurring</span>

<span class="c1"># define blurring kernel (pointspread function)</span>
<span class="n">psf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="o">/</span> <span class="mi">25</span>

<span class="c1"># convolve image with kernel</span>
<span class="n">astro_blur</span> <span class="o">=</span> <span class="n">conv2</span><span class="p">(</span><span class="n">astro</span><span class="p">,</span> <span class="n">psf</span><span class="p">,</span> <span class="s1">&#39;same&#39;</span><span class="p">)</span>
<span class="n">astro_blur</span> <span class="o">+=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">poisson</span><span class="p">(</span><span class="n">lam</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">astro</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="mf">255.</span>

<span class="c1"># Restore Image using Richardson-Lucy algorithm</span>
<span class="n">astro_restored</span> <span class="o">=</span> <span class="n">restoration</span><span class="o">.</span><span class="n">richardson_lucy</span><span class="p">(</span><span class="n">astro_blur</span><span class="p">,</span> <span class="n">psf</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># plot results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
       <span class="n">a</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">astro</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original image&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">astro_blur</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Blurred image&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">astro_restored</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Restored image&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="s2">&quot;An example of image deblurring. Do you think we would ever be able to fully recover the original image?&quot;</span><span class="p">,{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span><span class="mi">12</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/what_is_1_0.png" src="_images/what_is_1_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import libaries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">convolve2d</span> <span class="k">as</span> <span class="n">conv2</span>
<span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">color</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">restoration</span>
<span class="kn">from</span> <span class="nn">skimage.restoration</span> <span class="kn">import</span> <span class="n">inpaint</span>

<span class="c1"># load test image and convert to gray-scale</span>
<span class="n">astro</span> <span class="o">=</span> <span class="n">color</span><span class="o">.</span><span class="n">rgb2gray</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">astronaut</span><span class="p">())</span>

<span class="c1">## image inpainting</span>

<span class="c1"># Create mask with three defect regions: left, middle, right respectively</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">))</span>
<span class="n">mask</span><span class="p">[</span><span class="mi">20</span><span class="p">:</span><span class="mi">60</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">mask</span><span class="p">[</span><span class="mi">160</span><span class="p">:</span><span class="mi">180</span><span class="p">,</span> <span class="mi">70</span><span class="p">:</span><span class="mi">155</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">mask</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">60</span><span class="p">,</span> <span class="mi">170</span><span class="p">:</span><span class="mi">195</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># remove parts of the image</span>
<span class="n">astro_defect</span> <span class="o">=</span> <span class="n">astro</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">200</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">astro_defect</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># inpaint</span>
<span class="n">astro_inpainted</span> <span class="o">=</span> <span class="n">inpaint</span><span class="o">.</span><span class="n">inpaint_biharmonic</span><span class="p">(</span><span class="n">astro_defect</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">multichannel</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># plot results</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
       <span class="n">a</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">astro</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">200</span><span class="p">],</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original image&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">astro_defect</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Damaged image&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">astro_inpainted</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Restored image&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figtext</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="s2">&quot;An example of image inpainting. Do you think we would ever be able to fully recover the original image?&quot;</span><span class="p">,{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span><span class="mi">12</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/what_is_2_0.png" src="_images/what_is_2_0.png" />
</div>
</div>
</div>
<div class="section" id="x-ray-tomography">
<h3><span class="section-number">1.1.2. </span>X-ray tomography<a class="headerlink" href="#x-ray-tomography" title="Permalink to this headline">¶</a></h3>
<p>A CT-scanner is a common tool for medical diagnosis, providing detailed images of the anatomy of a patient. An example is shown in <a class="reference internal" href="#modernct"><span class="std std-numref">Fig. 1.2</span></a>. In other applications, such as materials science, similar techniques are being used to obtain three-dimensional reconstructions of the inner structure of objects.</p>
<div class="figure align-default" id="modernct">
<a class="reference internal image-reference" href="_images/ModernCT.png"><img alt="_images/ModernCT.png" src="_images/ModernCT.png" style="height: 150px;" /></a>
<p class="caption"><span class="caption-number">Fig. 1.2 </span><span class="caption-text">Modern CT scanner (left). Slice of high resolution CT scan of a patient’s lung (right). Source for both: Wikimedia Commons</span><a class="headerlink" href="#modernct" title="Permalink to this image">¶</a></p>
</div>
<p>In this case <span class="math notranslate nohighlight">\(u: \mathbb{R}^d \rightarrow \mathbb{R}\)</span>, represents the density of (a slice of) the object, which may in turn be thought of as an image. Different from the previous section is the relation to the measurements. A useful model for X-ray measurements turns out to be the <a class="reference external" href="https://en.wikipedia.org/wiki/X-ray_transform"><em>X-ray transform</em></a>, which for <span class="math notranslate nohighlight">\(d=2\)</span> is equivalent to the <a class="reference external" href="https://en.wikipedia.org/wiki/Radon_transform"><em>Radon transform</em></a>. This transforms the image <span class="math notranslate nohighlight">\(u\)</span> to a <em>sinogram</em> <span class="math notranslate nohighlight">\(f: \mathbb{R}^{d}\times \mathbb{S}^{d-1} \rightarrow \mathbb{R}\)</span> by taking line-integrals along straight lines at various angles and shifts:</p>
<div class="math notranslate nohighlight">
\[f(s,\xi) = \int_{\mathbb{R}} u(s + t \xi)\mathrm{d}t,\]</div>
<p>with <span class="math notranslate nohighlight">\(\xi \in \mathbb{S}^{d-1}\)</span> a direction on the unit sphere and <span class="math notranslate nohighlight">\(s \in \mathbb{R}^d\)</span> denoting the shift.</p>
<p>An example of an image and its corresponding sinogram are shown in figure <a class="reference internal" href="#walnut"><span class="std std-numref">Fig. 1.3</span></a>. It is clear that the sinogram itself is not directly suited for interpretation and we have to solve the inverse problem to get a useful image.</p>
<div class="figure align-default" id="walnut">
<a class="reference internal image-reference" href="_images/walnut.png"><img alt="_images/walnut.png" src="_images/walnut.png" style="height: 150px;" /></a>
<p class="caption"><span class="caption-number">Fig. 1.3 </span><span class="caption-text">Two-dimensional slice through a walnut and the corresponding sinogram.</span><a class="headerlink" href="#walnut" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="magnetic-resonance-imaging">
<h3><span class="section-number">1.1.3. </span>Magnetic resonance imaging<a class="headerlink" href="#magnetic-resonance-imaging" title="Permalink to this headline">¶</a></h3>
<p>Magnetic resonance imaging (MRI) is another imaging modality for clinical diagnosis. As opposed to CT, MRI does not rely on ionizing radiation and is hence considered much safer. A disadvantage of MRI is that the time needed for a scan is much longer than for CT.</p>
<p>Here, <span class="math notranslate nohighlight">\(u : \mathbb{R}^d \rightarrow \mathbb{C}\)</span>, is related to the proton density of the tissue and can be interpreted as an image. The physics behind the measurement process are quite complicated, but for most practical settings a useful model is based on the <a class="reference external" href="https://en.wikipedia.org/wiki/Fourier_transform"><em>Fourier transform</em></a> of <span class="math notranslate nohighlight">\(u\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\widehat{u}(\xi) = \frac{1}{(2\pi)^{d/2}}\int_{\mathbb{R}^d} u(x)e^{\imath \xi\cdot x}\mathrm{d}x.
\]</div>
<p>The measurements <span class="math notranslate nohighlight">\(f\)</span> are a finite set of samples of the spectrum <span class="math notranslate nohighlight">\(\widehat{u}\)</span>:</p>
<div class="math notranslate nohighlight">
\[
f_i = \widehat{u}(\xi_i), \quad i = 1, 2, \ldots, m.
\]</div>
<p>Note that when a fully sampled spectrum is available, we can easily retrieve <span class="math notranslate nohighlight">\(u\)</span> via the <em>inverse Fourier transform</em>:</p>
<div class="math notranslate nohighlight">
\[
u(x)= \frac{1}{(2\pi)^{d/2}}\int_{\mathbb{R}^d} \widehat{u}(\xi) e^{-\imath \xi\cdot x}\mathrm{d}\xi.
\]</div>
<p>The challenge here lies in retrieving <span class="math notranslate nohighlight">\(u\)</span> from a limited set of samples. As the time needed for a scan is proportional to the number of samples acquired, much research is being done on devising methods to recover images from under-sampled Fourier measurements.</p>
</div>
<div class="section" id="seismic-inversion">
<h3><span class="section-number">1.1.4. </span>Seismic inversion<a class="headerlink" href="#seismic-inversion" title="Permalink to this headline">¶</a></h3>
<p>In seismic inversion, the goal is to infer physical properties of the subsurface from seismic measurements. Here, <span class="math notranslate nohighlight">\(u\)</span> represents (for example) the elastic material parameters of the rock or the signature of an earth-quake. The measurements are typically time series of ground motion recorded by seismographs. A typical experimental setup is depicted in <a class="reference internal" href="#seismic-acquisition"><span class="std std-numref">Fig. 1.4</span></a>. A typical image resulting from such data is shown in <a class="reference internal" href="#seismic-image"><span class="std std-numref">Fig. 1.5</span></a>.</p>
<div class="figure align-default" id="seismic-acquisition">
<a class="reference internal image-reference" href="_images/Diagram_of_a_marine_seismic_survey.png"><img alt="_images/Diagram_of_a_marine_seismic_survey.png" src="_images/Diagram_of_a_marine_seismic_survey.png" style="height: 150px;" /></a>
<p class="caption"><span class="caption-number">Fig. 1.4 </span><span class="caption-text">A typical seismic acquisition setup.</span><a class="headerlink" href="#seismic-acquisition" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="seismic-image">
<a class="reference internal image-reference" href="_images/seismic_image.jpg"><img alt="_images/seismic_image.jpg" src="_images/seismic_image.jpg" style="height: 150px;" /></a>
<p class="caption"><span class="caption-number">Fig. 1.5 </span><span class="caption-text">A typical seismic image depicting various earth layers.</span><a class="headerlink" href="#seismic-image" title="Permalink to this image">¶</a></p>
</div>
<p>The simplest example is when the underlying physics can be described by a simple scalar wave equation:</p>
<div class="math notranslate nohighlight">
\[
\partial_t^2 p(t,x) - c(x) \nabla_x p(t,x) = q(t,x), \quad x \in\Omega, \quad t\in [0,T]
\]</div>
<p>where <span class="math notranslate nohighlight">\(p(t,x)\)</span> denotes the <em>wave field</em>, <span class="math notranslate nohighlight">\(c(x)\)</span> is related the sound speed and density of the medium and <span class="math notranslate nohighlight">\(q\)</span> is a source term. The measurements are given by</p>
<div class="math notranslate nohighlight">
\[
f_i(t) = p(t,x_i), \quad i \in \{1, 2, \ldots, m\}.
\]</div>
<p>The inverse problem consists of retrieving either <span class="math notranslate nohighlight">\(c\)</span> or <span class="math notranslate nohighlight">\(q\)</span> from the measurements <span class="math notranslate nohighlight">\(\{f_i\}_{i=0}^m\)</span>. In particular we distinguish two inverse problems</p>
<ul class="simple">
<li><p><em>Inverse source problem</em>: The measurements <span class="math notranslate nohighlight">\(f\)</span> are linear in terms of <span class="math notranslate nohighlight">\(q\)</span>, leading to a linear inverse problem to retrieve <span class="math notranslate nohighlight">\(q\)</span>. In earth-quake localization, the source is for example parametrized as <span class="math notranslate nohighlight">\(q(t,x) = u_1(t)u_2(x)\)</span> in which case the goal is to retrieve <span class="math notranslate nohighlight">\((u_1,u_2)\)</span>.</p></li>
<li><p><em>Inverse medium problem</em>: Here the goal is to retrieve <span class="math notranslate nohighlight">\(c\)</span>, sometimes parametrized as <span class="math notranslate nohighlight">\(c(x) = c_0(1 + u(x)).\)</span> Here, the measurements generally depend non-linearly on <span class="math notranslate nohighlight">\(u\)</span>. However, when <span class="math notranslate nohighlight">\(|u| \ll 1\)</span> the relation between <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(u\)</span> may be linearized.</p></li>
</ul>
</div>
</div>
<div class="section" id="anatomy-of-an-inverse-problems">
<h2><span class="section-number">1.2. </span>Anatomy of an inverse problems<a class="headerlink" href="#anatomy-of-an-inverse-problems" title="Permalink to this headline">¶</a></h2>
<p>We can abstractly formulate most (if not all) inverse problems as finding a solution, <span class="math notranslate nohighlight">\(u \in \mathcal{U}\)</span>, to the operator equation</p>
<div class="math notranslate nohighlight" id="equation-ip">
<span class="eqno">(1.1)<a class="headerlink" href="#equation-ip" title="Permalink to this equation">¶</a></span>\[K(u) = f.\]</div>
<p>Here, <span class="math notranslate nohighlight">\(K\)</span> is called the <em>forward operator</em>; <span class="math notranslate nohighlight">\(u\)</span> is the <em>image</em> or <em>parameter</em> and <span class="math notranslate nohighlight">\(f \in \mathcal{F}\)</span> are the measurements. The forward operator, <span class="math notranslate nohighlight">\(K : \mathcal{U} \rightarrow \mathcal{F}\)</span>, is a model of the underlying (physical) process and simulates the measurements for given <span class="math notranslate nohighlight">\(u\)</span>. It could represent for example an integral operator, a matrix, or a set of algebraic equations.
The image/parameters, <span class="math notranslate nohighlight">\(u\)</span>, constitute a mathematical description of the quantity of interest. It could for example be a function or a vector. The measurements, <span class="math notranslate nohighlight">\(f\)</span>, are a mathematical representation of the measured data. For the purposes of analysis, we may think of this a function, but in practice measurements are always a finite-dimensional quantity.</p>
<p>For the purposes of this course, we will assume that <span class="math notranslate nohighlight">\(\mathcal{U}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{F}\)</span> are <a class="reference external" href="https://en.wikipedia.org/wiki/Banach_space">Banach spaces</a> so we can measure distances between pairs of images and measurements. In many cases, <span class="math notranslate nohighlight">\(\mathcal{U}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{F}\)</span> will additionally have an inner-product in which case they are <a class="reference external" href="https://en.wikipedia.org/wiki/Hilbert_space">Hilbert spaces</a>.</p>
<p>An important notion in inverse problems is <em>ill-posedness</em>. We call a problem <em>ill-posed</em> if it is not <em>well-posed</em>:</p>
<div class="important admonition">
<p class="admonition-title">Definition: <em>Well-posedness according to Hadamard</em></p>
<p>The equation <span class="math notranslate nohighlight">\(K(u) = f\)</span> is <em>well-posed</em> if <em>all</em> three criteria are met:</p>
<ul class="simple">
<li><p><strong>Existence.</strong> There exists at least one <span class="math notranslate nohighlight">\(u\)</span> for which <span class="math notranslate nohighlight">\(K(u) = f\)</span></p></li>
<li><p><strong>Uniqueness.</strong> There is exactly one <span class="math notranslate nohighlight">\(u\)</span> for which <span class="math notranslate nohighlight">\(K(u) = f\)</span></p></li>
<li><p><strong>Stability.</strong> The solution depends continuously on the data, i.e., there is a constant <span class="math notranslate nohighlight">\(C &lt; \infty\)</span> such that <span class="math notranslate nohighlight">\(\|u - u'\| \leq C \|f - f'\|\)</span> where <span class="math notranslate nohighlight">\(K(u) = f\)</span> and <span class="math notranslate nohighlight">\(K(u') = f'\)</span>.</p></li>
</ul>
<p>If the problem is not well-posed, we call it <em>ill-posed</em>.</p>
</div>
<p>It may seem strange that equation <a class="reference internal" href="#equation-ip">(1.1)</a> may not have a solution. After all, are the measurements not the result of the forward operator applied to some ground-truth <span class="math notranslate nohighlight">\(\overline{u}\)</span>? We need to keep in mind here that <span class="math notranslate nohighlight">\(K\)</span> is only a <em>model</em> for the underlying process. In reality, the measurements may include <em>modeling errors</em> and <em>measurement errors</em>. We will denote the noisy data by <span class="math notranslate nohighlight">\(f^{\delta}\)</span>. An often-used model to incorporate such errors is the <em>additive noise model</em></p>
<div class="math notranslate nohighlight">
\[
f^{\delta} = K(\overline{u}) + e,
\]</div>
<p>where <span class="math notranslate nohighlight">\(e\)</span> represents the combined measurement and modeling error with <span class="math notranslate nohighlight">\(\|e\| \leq \delta\)</span>. If we find a <span class="math notranslate nohighlight">\(u\)</span> for which <span class="math notranslate nohighlight">\(Ku^{\delta} = f^{\delta}\)</span>, we can ask ourselves how big the <em>backward error</em> <span class="math notranslate nohighlight">\(\|u^{\delta} - \overline{u}\|\)</span> is with respect to the <em>forward error</em> <span class="math notranslate nohighlight">\(\|e\|\)</span>. In practice we call a problem ill-posed if a small error in the data can cause a large error in the reconstruction.</p>
</div>
<div class="section" id="motivating-examples">
<h2><span class="section-number">1.3. </span>Motivating examples<a class="headerlink" href="#motivating-examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="rootfinding">
<h3><span class="section-number">1.3.1. </span>Rootfinding<a class="headerlink" href="#rootfinding" title="Permalink to this headline">¶</a></h3>
<p>Given a continuous function <span class="math notranslate nohighlight">\(K : \mathbb{R} \rightarrow \mathbb{R}\)</span>, and <span class="math notranslate nohighlight">\(f \in \mathbb{R}\)</span> find <span class="math notranslate nohighlight">\(u\)</span> such that <span class="math notranslate nohighlight">\(K(u) = f\)</span>. The <a class="reference external" href="https://en.wikipedia.org/wiki/Inverse_function_theorem">inverse function theorem</a> tells us that
the inverse of <span class="math notranslate nohighlight">\(K\)</span> exists (at least locally around <span class="math notranslate nohighlight">\(u\)</span>) if <span class="math notranslate nohighlight">\(K\)</span> is continuously differentiable at <span class="math notranslate nohighlight">\(u\)</span> with <span class="math notranslate nohighlight">\(K'(u)\not= 0\)</span>. The solution is in this case give by <span class="math notranslate nohighlight">\(u = K^{-1}(f)\)</span>. For sensitivity we consider <span class="math notranslate nohighlight">\(K(u) - K(v) = f - g\)</span>, leading to</p>
<div class="math notranslate nohighlight">
\[
u - v = K^{-1}(f) - K^{-1}(g) = \left(K^{-1}\right)'(\xi)(f-g), \quad \xi \in [f,g].
\]</div>
<p>We can thus derive the error bound</p>
<div class="math notranslate nohighlight">
\[
|u - v| \leq C |f - g|,
\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[
C = \sup_{\xi\in [f,g]} |\left(K^{-1}\right)'(\xi)| = \sup_{\xi\in [f,g]} |\left(K'(\xi)\right)^{-1}|.
\]</div>
<p>We conclude that the problem of finding a root of <span class="math notranslate nohighlight">\(K(u) - f\)</span> is ill-posed when the derivative of <span class="math notranslate nohighlight">\(K\)</span> is small near the root.</p>
</div>
<div class="section" id="matrix-inversion">
<h3><span class="section-number">1.3.2. </span>Matrix inversion<a class="headerlink" href="#matrix-inversion" title="Permalink to this headline">¶</a></h3>
<p>Matrix inversion is a prime example of a linear inverse problem. These can be written in the form of <a class="reference internal" href="#equation-ip">(1.1)</a> with <span class="math notranslate nohighlight">\(u \in \mathbb{C}^n\)</span> and <span class="math notranslate nohighlight">\(f \in \mathbb{C}^n\)</span> being <span class="math notranslate nohighlight">\(n\)</span>-dimensional vectors and <span class="math notranslate nohighlight">\(K \in \mathbb{C}^{n \times n}\)</span> being a matrix. For now, we further assume <span class="math notranslate nohighlight">\(K\)</span> to be a <a class="reference external" href="https://en.wikipedia.org/wiki/Hermitian_matrix">Hermitian</a>, <a class="reference external" href="https://en.wikipedia.org/wiki/Definite_symmetric_matrix">positive definite matrix</a>. In that case we know from the <a class="reference external" href="https://en.wikipedia.org/wiki/Spectral_theorem">spectral theorem</a> that there exist real positive eigenvalues <span class="math notranslate nohighlight">\(\lambda_1 \geq \lambda_2 \geq \cdots \geq \lambda_n &gt; 0\)</span> and corresponding orthonormal eigenvectors <span class="math notranslate nohighlight">\(k_j \in \mathbb{C}^n\)</span> for <span class="math notranslate nohighlight">\(j \in \{ 1,\cdots,n \}\)</span> such that <span class="math notranslate nohighlight">\(K\)</span> can be written as</p>
<div class="math notranslate nohighlight">
\[
K = \sum_{j=1}^n \lambda_j k_j k_j^{*}.
\]</div>
<p>Under these conditions <span class="math notranslate nohighlight">\(K\)</span> is invertible so <em>existence</em> and <em>uniqueness</em> of a solution of <a class="reference internal" href="#equation-ip">(1.1)</a> are guaranteed. Regarding <em>stability</em>, however, it is well known from numerical linear algebra that a small perturbation of <span class="math notranslate nohighlight">\(f\)</span> may lead to large perturbation of the corresponding solution if the matrix is <em>ill-conditioned</em>. In particular, we have</p>
<div class="math notranslate nohighlight">
\[
\frac{\|u - u^\delta\|}{\|u\|} \leq \kappa(K) \frac{\|f - f^\delta\|}{\|f\|},
\]</div>
<p>where <span class="math notranslate nohighlight">\(\kappa(K) = \|K^{-1}\|\|K\|\)</span> is called the <a class="reference external" href="https://en.wikipedia.org/wiki/Condition_number"><em>condition number</em></a> of <span class="math notranslate nohighlight">\(K\)</span>. Hence, we observe that in the worst case an error in the measured data is amplified by the condition number. A matrix with large <span class="math notranslate nohighlight">\(\kappa\)</span> is therefore called <em>ill-conditioned</em>.</p>
</div>
<div class="section" id="differentiation">
<h3><span class="section-number">1.3.3. </span>Differentiation<a class="headerlink" href="#differentiation" title="Permalink to this headline">¶</a></h3>
<p>Here, we are given a <a class="reference external" href="https://en.wikipedia.org/wiki/Smoothness">continuously differentiable function</a> <span class="math notranslate nohighlight">\(f \in C^{1}([0,1])\)</span> with <span class="math notranslate nohighlight">\(f(0) = 0\)</span> and define the forward operator as</p>
<div class="math notranslate nohighlight">
\[
Ku(x) = \int_0^x u(y) \mathrm{d}y.
\]</div>
<p>We immediately find that the solution is given by <span class="math notranslate nohighlight">\(u(x) = f'(x)\)</span>. Hence, the solution is well-defined and unique. For sensitivity, assume that we are given a noisy version of the signal <span class="math notranslate nohighlight">\(f^{\delta} = f + n^{\delta}\)</span>, with <span class="math notranslate nohighlight">\(n^{\delta} \in L^{\infty}([0,1])\)</span>, with <span class="math notranslate nohighlight">\(L^{\infty}([0,1])\)</span> denoting the <a class="reference external" href="https://en.wikipedia.org/wiki/L-infinity">space of bounded measurable functions</a>. An example of such noise is</p>
<div class="math notranslate nohighlight">
\[
n^{\delta}(x) = \delta \sin(x/\delta).
\]</div>
<p>It is not hard to show in this case that the forward error <span class="math notranslate nohighlight">\(\|f^{\delta} - f\|_{L^{\infty}([0,1])} \rightarrow 0\)</span> as <span class="math notranslate nohighlight">\(\delta \rightarrow 0\)</span> but that the backward error <span class="math notranslate nohighlight">\(\|u - u^{\delta}\|_{L^{\infty}([0,1])}\)</span> is constant. In the exercises we will see that the ill-posedness can be alleviated to some extent by demanding more regularity from the noise.</p>
</div>
</div>
<div class="section" id="solving-an-inverse-problem">
<h2><span class="section-number">1.4. </span>Solving an inverse problem<a class="headerlink" href="#solving-an-inverse-problem" title="Permalink to this headline">¶</a></h2>
<div class="section" id="direct-methods">
<h3><span class="section-number">1.4.1. </span>Direct methods<a class="headerlink" href="#direct-methods" title="Permalink to this headline">¶</a></h3>
<p>In some special cases we can derive an explicit expression for (an approximation) of the solution of <span class="math notranslate nohighlight">\(K(u) = f\)</span>. For example, if <span class="math notranslate nohighlight">\(K\)</span> represents a quadratic equation in one variable or a system of linear equations. In other cases, we may have an explicit expression for the inverse of a slightly modified forward operator, <span class="math notranslate nohighlight">\(\widetilde{K}\)</span>. This modified operator arises when the original inverse problem is ill-posed and is replaced by a modified inverse problem <span class="math notranslate nohighlight">\(\widetilde{K}(u) = f\)</span> which is well-posed. The hope, in the latter case, is that <span class="math notranslate nohighlight">\(\widetilde{K}\)</span> approximates <span class="math notranslate nohighlight">\(K\)</span> well for the class of solutions we are looking for.</p>
<div class="admonition-example-inverting-a-rank-deficient-matrix admonition">
<p class="admonition-title">Example: <em>Inverting a rank-deficient matrix.</em></p>
<p>Consider the matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}
K = \left(\begin{matrix} 1 &amp; 1\\ 2 &amp; 2 \end{matrix}\right).
\end{split}\]</div>
<p>Obviously this matrix is singular, so there is no way to define the inverse in the usual sense. However, modifying the matrix slightly</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\widetilde{K} = \left(\begin{matrix} 1 + \alpha &amp; 1\\ 2 &amp; 2 + \alpha\end{matrix}\right),
\end{split}\]</div>
<p>allows us to compute the inverse. Indeed, given <span class="math notranslate nohighlight">\(f = K\overline{u}\)</span> with <span class="math notranslate nohighlight">\(\overline{u} = (1,2)\)</span> we have <span class="math notranslate nohighlight">\(f = (3,6)\)</span>. Applying the inverse of <span class="math notranslate nohighlight">\(\widetilde{K}\)</span> we get <span class="math notranslate nohighlight">\(\widetilde{u} \approx (1,2)\)</span>. The corresponding equations are visualized in <a class="reference internal" href="#id2"><span class="std std-numref">Fig. 1.6</span></a>.</p>
<div class="figure align-default" id="id2" style="width: 300px">
<div class="cell_output docutils container">
<img alt="_images/what_is_10_1.png" src="_images/what_is_10_1.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 1.6 </span><span class="caption-text">Original and regularized equations. We see that the regularized equations have a unique solution, but this solution is slightly biased towards the origin.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">u1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">u2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1e-1</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="mi">3</span><span class="o">-</span><span class="n">u1</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$Ku=f$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span><span class="mi">3</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="n">u1</span><span class="p">,</span><span class="s1">&#39;r--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\widetilde</span><span class="si">{K}</span><span class="s1">u=f$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u1</span><span class="p">,(</span><span class="mi">6</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">u1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">alpha</span><span class="p">),</span><span class="s1">&#39;r--&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$u_1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$u_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;matrix_inversion&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/what_is_10_0.png" src="_images/what_is_10_0.png" />
</div>
</div>
</div>
<div class="section" id="variational-methods">
<h3><span class="section-number">1.4.2. </span>Variational methods<a class="headerlink" href="#variational-methods" title="Permalink to this headline">¶</a></h3>
<p>Variational methods are a popular and quite generally applicable technique for solving inverse problems. The idea is to replace the original equation <span class="math notranslate nohighlight">\(K(u) = f\)</span> by a minimization problem. To do this, one constructs an optimization problem with a functional consisting of two terms. The first part is the data fidelity and is supposed to ensure that <span class="math notranslate nohighlight">\(K(u) \approx f\)</span>.
The second part is the regularization functional which incorporates the a-priori information on <span class="math notranslate nohighlight">\(u\)</span>. Thereby, we obtain a problem of the form</p>
<div class="math notranslate nohighlight">
\[
\min_{u \in \mathcal{U}} D(u,f) + \alpha R(u)
\]</div>
<p>where further a-priori information on the class of images <span class="math notranslate nohighlight">\(u\)</span>, over which we minimize, can be contained, e.g. non-negativity for density images. The data fidelity term <span class="math notranslate nohighlight">\(D\)</span> should be constructed in such a way, that <span class="math notranslate nohighlight">\(D\)</span> attains its minimum (often normalized at zero) if the data are reconstructed exactly. The regularization functional should be constructed in such a way, that <span class="math notranslate nohighlight">\(R\)</span> attains a small value if the image matches the a-priori information very well, and a very large value, if the image does not fit to the available a-priori information. As a result, such images will be unlikely to minimize the functional. The parameter <span class="math notranslate nohighlight">\(\alpha\)</span> weights the two parts of the functional. For very small <span class="math notranslate nohighlight">\(\alpha\)</span> the emphasis lies on fitting the data, whereas with increasing <span class="math notranslate nohighlight">\(\alpha\)</span> the regularization gains in importance in this ratio, which is particularly essential if measurement errors or noise can be expected.</p>
<div class="admonition-example-solving-a-quadratic-equation admonition">
<p class="admonition-title">Example: <em>Solving a quadratic equation.</em></p>
<p>We illustrate this principle by a simple example. We search for a <em>small</em> solution of the following quadratic equation</p>
<div class="math notranslate nohighlight">
\[
	u^2 - f_1 u + f_2 = 0,
\]</div>
<p>with the given data <span class="math notranslate nohighlight">\(f_1=1.1\)</span> and <span class="math notranslate nohighlight">\(f_2 = .1\)</span>.
With the solution formula for quadratic equations we obtain two solutions</p>
<div class="math notranslate nohighlight">
\[
	u_1 = 0.1 \qquad \text{and} \qquad u_2 = 1.
\]</div>
<p>With our a-priori information of a <em>small</em> solution we obviously choose the solution <span class="math notranslate nohighlight">\(u_1\)</span>. However, this is only possible in this specific case, because we can indeed compute <em>all</em> solutions. For more complicated problems this is not possible anymore. Moreover, we have to face measurement errors, such that we should better compute an approximate solution in a robust manner than many exact solutions. A variational approach can be realised for this example by minimizing the functional</p>
<div class="math notranslate nohighlight">
\[
	J(u) = (u^2 - f_1 u + f_2)^2 + \alpha u^2.
\]</div>
<p>For <span class="math notranslate nohighlight">\(\alpha\)</span> large, this functional has a global minimum around <span class="math notranslate nohighlight">\(u = 0\)</span>, while for <span class="math notranslate nohighlight">\(\alpha\)</span> small, it still has multiple minima. However, for suitable <span class="math notranslate nohighlight">\(\alpha\)</span>, we have a global minimum at <span class="math notranslate nohighlight">\(u \approx 0.1\)</span> and minimzing the regularized problem yields (an approximation of) the smaller solution, as illustrated in <a class="reference internal" href="#quadratic"><span class="std std-numref">Fig. 1.7</span></a>.</p>
<div class="figure align-default" id="quadratic" style="width: 300px">
<div class="cell_output docutils container">
<img alt="_images/what_is_12_1.png" src="_images/what_is_12_1.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 1.7 </span><span class="caption-text">Original quadratic equation and functional to be minimized. We see that minimizing the functional picks out one of the two solutions.</span><a class="headerlink" href="#quadratic" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">1.1</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;ko&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;ko&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">alpha</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,(</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">1.1</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\alpha=$&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">alpha</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$u$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.5</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">.25</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;quadratic&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/what_is_12_0.png" src="_images/what_is_12_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="excercises">
<h2><span class="section-number">1.5. </span>Excercises<a class="headerlink" href="#excercises" title="Permalink to this headline">¶</a></h2>
<div class="section" id="matrix-inversion-i">
<h3><span class="section-number">1.5.1. </span>Matrix inversion I<a class="headerlink" href="#matrix-inversion-i" title="Permalink to this headline">¶</a></h3>
<p>We want to solve a system of linear equations <span class="math notranslate nohighlight">\(Ku = f\)</span> with :</p>
<ol>
<li><div class="math notranslate nohighlight">
\[\begin{split}K = \left(\begin{matrix} 1 &amp; 2 \\ 2 &amp; 1\end{matrix}\right), \quad f = \left(\begin{matrix} 1 \\ 1 \end{matrix}\right),\end{split}\]</div>
</li>
<li><div class="math notranslate nohighlight">
\[\begin{split}K = \left(\begin{matrix} 1 &amp; 1 \\ 1 &amp; 1.001\end{matrix}\right), \quad f = \left(\begin{matrix} 1 \\ 1 \end{matrix}\right),\end{split}\]</div>
</li>
<li><div class="math notranslate nohighlight">
\[\begin{split}K = \left(\begin{matrix} 1 &amp; 1 \\ 2 &amp; 1 \\ 2 &amp; 2\end{matrix}\right), \quad f = \left(\begin{matrix} 1 \\ 1 \\ 1\end{matrix}\right),\end{split}\]</div>
</li>
<li><div class="math notranslate nohighlight">
\[\begin{split}K = \left(\begin{matrix} 1 &amp; 1 \\ 2 &amp; 1 \\ 2 &amp; 2\end{matrix}\right), \quad f = \left(\begin{matrix} 1 \\ 2 \\ 2\end{matrix}\right),\end{split}\]</div>
</li>
<li><div class="math notranslate nohighlight">
\[\begin{split}K = \left(\begin{matrix} 1 &amp; 2 &amp; 1\\ 2 &amp; 0 &amp; 2\end{matrix}\right), \quad f = \left(\begin{matrix} 1 \\ 1 \end{matrix}\right),\end{split}\]</div>
</li>
<li><div class="math notranslate nohighlight">
\[\begin{split}K = \left(\begin{matrix} 1 &amp; 0 \\ 0 &amp; 0\end{matrix}\right), \quad f = \left(\begin{matrix} 0 \\ 1 \end{matrix}\right),\end{split}\]</div>
</li>
</ol>
<p>Is the problem ill-posed? Why? You can compute eigenvalues and vectors numerically, as shown in the example below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">l</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The eigenvalues are:&quot;</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The eigenvectors are:&quot;</span><span class="p">,</span><span class="n">V</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">V</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The eigenvalues are: [ 3. -1.]
The eigenvectors are: [0.70710678 0.70710678] [-0.70710678  0.70710678]
</pre></div>
</div>
</div>
</div>
<div class="hint dropdown admonition">
<p class="admonition-title">Answer</p>
<ol class="simple">
<li><p>This matrix is invertible, so we only need to check the condition number which we find to be <span class="math notranslate nohighlight">\(3\)</span>. This is not so large as to cause problems numerically.</p></li>
<li><p>This matrix is near singular (the columns are nearly linearly dependent). However, it still invertible. The condition number is <span class="math notranslate nohighlight">\(\kappa(K) \approx 4\cdot 10^3\)</span>. While this would not lead to problems when computing solutions numerically, it may amplify realistic measurement errors. We would call this problem ill-posed.</p></li>
<li><p>This equation does not have a solution.</p></li>
<li><p>This equation does have a unique solution <span class="math notranslate nohighlight">\(\overline{u} = (1,0)\)</span>. It is not immediately clear how to analyse stability in general. We could, for example, look at the first two equations (the last one is the same as the first one) and compute the condition number of the corresponding matrix. This yields <span class="math notranslate nohighlight">\(\approx 6.85\)</span>, so the system is not ill-posed. Another way to look at it, perhaps, is that adding a small perturbation may make the system inconsistent. As such, we could call the inverse problem ill-posed.
We will learn how to deal with this situation in general in the next chapter.</p></li>
<li><p>Here, the solutions are of the form <span class="math notranslate nohighlight">\(\overline{u} = (1/4,1/4,1/4) + t (-1,0,1)\)</span> for any <span class="math notranslate nohighlight">\(t\)</span>. Hence, the system is definitely ill-posed.</p></li>
<li><p>Again, an inconsistent system with no solution.</p></li>
</ol>
</div>
</div>
<div class="section" id="matrix-inversion-ii">
<h3><span class="section-number">1.5.2. </span>Matrix inversion II<a class="headerlink" href="#matrix-inversion-ii" title="Permalink to this headline">¶</a></h3>
<p>Given a symmetric, positive definite matrix <span class="math notranslate nohighlight">\(K \in \mathbb{R}^{n\times n}\)</span> we want to solve <span class="math notranslate nohighlight">\(Ku = f\)</span>. Such a matrix can be decomposed as</p>
<div class="math notranslate nohighlight">
\[K = \sum_{i=1}^n \lambda_i k_ik_i^{*},\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda_1\geq \lambda_2 \geq \ldots \geq \lambda_n &gt; 0\)</span> are the eigenvalues and <span class="math notranslate nohighlight">\(k_i\)</span> denote the eigenvectors. Such a matrix has an inverse given by</p>
<div class="math notranslate nohighlight">
\[K^{-1} = \sum_{i=1}^n \lambda_i^{-1} k_ik_i^{*}.\]</div>
<p>To study the well-posedness of the equation we want to bound the <em>backward error</em> <span class="math notranslate nohighlight">\(\|u - u^\delta\|_2\)</span> in terms of the <em>forward error</em> <span class="math notranslate nohighlight">\(\|f - f^{\delta}\|_2\)</span> where <span class="math notranslate nohighlight">\(Ku = f\)</span> and <span class="math notranslate nohighlight">\(Ku^{\delta} = f^\delta\)</span>.</p>
<ol class="simple">
<li><p>Show that <span class="math notranslate nohighlight">\(\|u - u^\delta\|_2 \leq \lambda_n^{-1} \|f - f^{\delta}\|_2.\)</span></p></li>
<li><p>Show that the <em>relative error</em> is bounded by
<span class="math notranslate nohighlight">\(\frac{\|u - u^\delta\|_2}{\|u\|_2} \leq \lambda_1\lambda_n^{-1} \frac{\|f - f^{\delta}\|_2}{\|f\|_2}.\)</span></p></li>
</ol>
<div class="hint dropdown admonition">
<p class="admonition-title">Answer</p>
<ol class="simple">
<li><p>We have <span class="math notranslate nohighlight">\(\|u - u^\delta\|_2 = \|K^{-1}(f - f^\delta)\|_2 \leq \|K^{-1}\| \|f - f^\delta\|_2\)</span> with <span class="math notranslate nohighlight">\(\|K^{-1}\|\)</span> denoting the operator norm of <span class="math notranslate nohighlight">\(K^{-1}\)</span>, defined as <span class="math notranslate nohighlight">\(\sup_{\|v\|_2=1} \|K^{-1}v\|\)</span>. The supremum is attained at <span class="math notranslate nohighlight">\(v = k_n\)</span> which leads to <span class="math notranslate nohighlight">\(\|K^{-1}\|_2 = \lambda_n^{-1}\)</span>.</p></li>
<li><p>Similarly, we find <span class="math notranslate nohighlight">\(\|f\|_2 = \|Ku\|_2 \leq \lambda_1 \|u\|_2\)</span>.</p></li>
</ol>
</div>
</div>
<div class="section" id="differentiation-i">
<h3><span class="section-number">1.5.3. </span>Differentiation I<a class="headerlink" href="#differentiation-i" title="Permalink to this headline">¶</a></h3>
<p>We are given a continuously differentiable function <span class="math notranslate nohighlight">\(f \in C^1([0,1])\)</span> with <span class="math notranslate nohighlight">\(f(0) =0\)</span> and want to solve the following inverse problem</p>
<div class="math notranslate nohighlight">
\[ Ku(x) \equiv \int_0^{x} u(y)\mathrm{d}y = f(x), \quad \text{for} \quad x \in [0,1].\]</div>
<p>It is readily verified that we can find a (unique) solution by differentiation: <span class="math notranslate nohighlight">\(u(x) = f'(x)\)</span>. To study well-posedness of the problem, we consider <em>noisy</em> measurements <span class="math notranslate nohighlight">\(f^{\delta}(x) = f(x) + \delta\sin(k x /\delta)\)</span> for fixed  arbitrary <span class="math notranslate nohighlight">\(k\)</span> and small <span class="math notranslate nohighlight">\(\delta &gt; 0\)</span>. Let</p>
<div class="math notranslate nohighlight">
\[\|g\|_{L^{\infty}([0,1])} = \sup_{x\in[0,1]} |g(x)|.\]</div>
<ol class="simple">
<li><p>Show that the <em>forward error</em> <span class="math notranslate nohighlight">\(f - f^{\delta}\)</span> is bounded in the <span class="math notranslate nohighlight">\(L^{\infty}\)</span> norm, in particular <span class="math notranslate nohighlight">\(\|f - f^{\delta}\|_{L^{\infty}([0,1])} \leq \delta\)</span>.</p></li>
<li><p>Show that the <em>backward error</em> <span class="math notranslate nohighlight">\(u - u^{\delta}\)</span> can be arbitrarily large, even if <span class="math notranslate nohighlight">\(\delta\downarrow 0\)</span>: <span class="math notranslate nohighlight">\(\|u - u^{\delta}\|_{L^{\infty}([0,1])} = k\)</span>.</p></li>
<li><p>Is the inverse problem ill-posed?</p></li>
</ol>
<div class="hint dropdown admonition">
<p class="admonition-title">Answer</p>
<ol class="simple">
<li><p>Since <span class="math notranslate nohighlight">\(|\sin(\cdot)| \leq 1\)</span> we immediately get the desired result.</p></li>
<li><p>By linearity we have <span class="math notranslate nohighlight">\(u - u^\delta = k \cos(k x/\delta)\)</span> and we immediately find the desired result.</p></li>
<li><p>This shows that the problem is <em>ill-conditioned</em>; a small forward error does not guarantee a small backward error, implying that the inverse map is not continuous.</p></li>
</ol>
</div>
</div>
</div>
<div class="section" id="assignments">
<h2><span class="section-number">1.6. </span>Assignments<a class="headerlink" href="#assignments" title="Permalink to this headline">¶</a></h2>
<div class="section" id="differentiation-ii">
<h3><span class="section-number">1.6.1. </span>Differentiation II<a class="headerlink" href="#differentiation-ii" title="Permalink to this headline">¶</a></h3>
<p>The analysis in the previous exercise depends crucially on the type of noise we allow. If we assume that <span class="math notranslate nohighlight">\(n^{\delta} = f - f^{\delta}\)</span> is bounded by <span class="math notranslate nohighlight">\(\delta\)</span> in a different norm, we can get a well-posed problem. Let</p>
<div class="math notranslate nohighlight">
\[\|g\|_{W^{1,\infty}([0,1])} = \|g\|_{L^{\infty}[0,1]} + \|g'\|_{L^{\infty}[0,1]},\]</div>
<p>denotes the <a class="reference external" href="https://en.wikipedia.org/wiki/Sobolev_space#One-dimensional_case"><span class="math notranslate nohighlight">\(W^{1,\infty}\)</span>-Sobolev norm</a></p>
<ol class="simple">
<li><p>Assuming that <span class="math notranslate nohighlight">\(\|n^{\delta}\|_{W^{1,\infty}([0,1])} = \delta\)</span>, show that <span class="math notranslate nohighlight">\(\|u - u^{\delta}\|_{L^{\infty}([0,1])} \rightarrow 0\)</span> when <span class="math notranslate nohighlight">\(\delta \rightarrow 0\)</span>.</p></li>
<li><p>Can you come up with a type of noise that obeys the assumed bound? Is it reasonable to make such assumptions on the noise?</p></li>
</ol>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Welcome to Inverse Problems and Imaging</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="discrete_ip_regularization.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Discrete Inverse Problems and Regularization</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Tristan van Leeuwen and Christoph Brune (CC BY-NC 4.0)<br/>
    
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>